---
import { desc } from "drizzle-orm";
import AppHeader from "~/components/astro/app-header.astro";
import HistoryList from "~/components/features/history-list";
import { createDb } from "~/server/db";
import { lists } from "~/server/db/schema";
import Layout from "../layouts/Layout.astro";

const db = createDb(Astro.locals.runtime.env.DB);
const allLists = await db.select().from(lists).orderBy(desc(lists.createdAt));
---

<Layout title="History">
  <AppHeader title="History" showBack backUrl="/" />

  <main class="px-4 py-6 space-y-6">
    <HistoryList lists={allLists} origin={Astro.url.origin} client:load />
  </main>
</Layout>
