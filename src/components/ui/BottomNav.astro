---
import { Home, List, Plus } from "lucide-solid";

const currentPath = Astro.url.pathname;

const isActive = (path: string) => {
	if (path === "/" && currentPath === "/") return true;
	if (path !== "/" && currentPath.startsWith(path)) return true;
	return false;
};

const navItems = [
	{ href: "/", label: "Home", icon: Home },
	{ href: "/create", label: "New", icon: Plus, isPrimary: true },
	{ href: "/history", label: "History", icon: List },
];
---

<nav class="fixed bottom-0 left-0 right-0 z-50 bg-background border-t border-border safe-area-bottom pb-[env(safe-area-inset-bottom)]">
  <div class="flex h-16 items-center justify-around px-4">
    {navItems.map((item) => {
      const active = isActive(item.href);
      const Icon = item.icon;

      if (item.isPrimary) {
        return (
          <a href={item.href} class="flex flex-col items-center justify-center p-2">
            <div class={`flex h-12 w-12 items-center justify-center rounded-full shadow-md transition-colors ${active ? "bg-primary text-primary-foreground" : "bg-secondary text-secondary-foreground hover:bg-secondary/80"}`}>
              <Icon class="size-6" />
            </div>
            <span class="sr-only">{item.label}</span>
          </a>
        );
      }

      return (
        <a href={item.href} class={`flex flex-1 flex-col items-center gap-1 p-2 transition-colors ${active ? "text-primary font-medium" : "text-muted-foreground hover:text-foreground"}`}>
          <Icon class="size-6" />
          <span class="text-xs">{item.label}</span>
        </a>
      );
    })}
  </div>
</nav>
